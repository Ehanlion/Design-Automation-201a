EE 201A Lab 3 Report
Ethan Owen (UID: 905452983)
==========================================

PROBLEM 1: Total HPWL Calculation
----------------------------------

Algorithm Description:
The algorithm computes total Half-Perimeter Wirelength (HPWL) for all 324 nets in the design, including power, ground, clock, floating, and signal nets.

Endpoint Policy (primary implementation):
- Primary I/O terminals (oaTerm): merge all pin figures for a terminal and use the center point of that merged terminal geometry.
- Instance terminals (oaInstTerm): use the center point of the instance bounding box.

For each net:
1. Collect all endpoint points from primary I/O terminals and instance terminals.
2. Compute xmin, xmax, ymin, ymax over those points.
3. HPWL = (xmax - xmin) + (ymax - ymin).
4. If no valid endpoint geometry is present, HPWL is 0.

Results:
- Total nets in design: 324
- Total HPWL: 5,599,970 DBU

Assumptions:
- All nets are included with no exclusions.
- Top-level term endpoints are term centers.
- Instance endpoints are instance centers.
- Nets with fewer than 2 distinct endpoint positions naturally produce HPWL = 0.


PROBLEM 2: Incremental Placement Algorithm
-------------------------------------------

Algorithm Approach:
A signal-net-focused batch-greedy swap algorithm optimized for the score metric:
Score = HPWL^2 * Time.

High-level Steps:
1. Build cached data in one OA traversal (instance centers, net endpoint bounds, legal swap groups).
2. Exclude non-signal nets from swap delta evaluation (VSS, VDD, blif_clk_net, blif_reset_net, UNCONNECTED*).
3. Prune candidate instance groups to only instances connected to signal nets.
4. Evaluate legal pair swaps in cache-only arithmetic and keep only improving candidates.
5. Sort candidates by best improvement and greedily commit non-conflicting swaps.
6. Recompute final total HPWL from cache over all nets.

Results (current run):
- Original HPWL: 5,599,970 DBU
- Final HPWL: 5,599,210 DBU
- HPWL Reduction: 760 DBU (0.01%)
- Number of swaps: 2
- Execution time: 0.000966 sec
- Score (HPWL^2 * Time): 3.0285e+10

Runtime Note:
Timing varies with server load, so rerunning is recommended when collecting final score numbers.

Origin example:
- `lab3/lab3_origin.cpp` is provided as a comparison-only example that uses instance origins.
- `lab3/scripts/runLab3Origin.sh` builds and runs that variant.
- Primary graded implementation remains `lab3/lab3.cpp` via `lab3/scripts/runLab3.sh`.
